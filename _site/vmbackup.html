<!DOCTYPE html> <html lang="en" dir="auto"> <head><meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5, user-scalable=no"> <meta name="description" content="vmbackup vmbackup creates VictoriaMetrics data backups from instant snapshots. Supported storage systems for backups: GCS. Example: gcs://&amp;lt;b..."> <meta name="revised" content="156072bda364bc719a657b8c14a5f5ba4c757132"> <meta name="author" content="Brensted"> <meta name="generator" content="rundocs/jekyll-rtd-theme v2.0.10"><meta name="theme-color" content="#2980b9"> <title>vmbackup 路 VictoriaMetrics</title> <meta name="twitter:title" content="vmbackup 路 VictoriaMetrics"> <meta name="twitter:description" content="vmbackup vmbackup creates VictoriaMetrics data backups from instant snapshots. Supported storage systems for backups: GCS. Example: gcs://&amp;lt;b..."> <meta name="twitter:card" content="summary"> <meta name="twitter:site" content="@Brensted"> <meta name="twitter:url" content="http://localhost:4000/vmbackup.html"> <meta name="twitter:creator" content="@rundocs/jekyll-rtd-theme v2.0.10"> <meta property="og:title" content="vmbackup 路 VictoriaMetrics"> <meta property="og:description" content="vmbackup vmbackup creates VictoriaMetrics data backups from instant snapshots. Supported storage systems for backups: GCS. Example: gcs://&amp;lt;b..."> <meta property="og:locale" content="en"> <meta property="og:url" content="http://localhost:4000/vmbackup.html"> <meta property="og:type" content="article"> <meta property="article:author" content="Brensted"> <meta property="article:published_time" content="2021-02-25T10:08:59+02:00"> <meta property="article:modified_time" content="2021-02-25T10:28:47+02:00"> <script type="application/ld+json"> { "@context": "https://schema.org", "@type": "Article", "mainEntityOfPage": { "@type": "WebPage", "@id": "http://localhost:4000/vmbackup.html" }, "headline": "vmbackup 路 VictoriaMetrics", "image": [], "author": { "@type": "Person", "name": "Brensted" }, "datePublished": "2021-02-25T10:08:59+02:00", "dateModified": "2021-02-25T10:28:47+02:00", "publisher": { "@type": "User", "name": "Brensted", "logo": { "@type": "ImageObject", "url": "https://avatars.githubusercontent.com/u/75306281?v=4" } }, "description": "vmbackup vmbackup creates VictoriaMetrics data backups from instant snapshots. Supported storage systems for backups: GCS. Example: gcs://&amp;lt;b..." } </script> <link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="prev" href="http://localhost:4000/vmauth.html"><link rel="next" href="http://localhost:4000/vmctl.html"><link rel="canonical" href="http://localhost:4000/vmbackup.html"><link rel="icon" type="image/svg+xml" href="/assets/images/favicon.svg"><link rel="icon" type="image/png" href="/assets/images/favicon-16x16.png" sizes="16x16"> <link rel="icon" type="image/png" href="/assets/images/favicon-32x32.png" sizes="32x32"> <link rel="icon" type="image/png" href="/assets/images/favicon-96x96.png" sizes="96x96"><link rel="mask-icon" href="/assets/images/favicon.svg" color="#2980b9"><link rel="apple-touch-icon" href="/assets/images/apple-touch-icon-300x300.jpg"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/rundocs/jekyll-rtd-theme@2.0.10/assets/css/theme.min.css"><script> window.ui = { title: "VictoriaMetrics", baseurl: "", i18n: { search_results: "Search Results", search_results_found: "Search finished, found # page(s) matching the search query.", search_results_not_found: "Your search did not match any documents, please make sure that all characters are spelled correctly!" } }; </script> </head> <body class="container"><div class="sidebar-wrap overflow-hidden"> <div class="sidebar height-full overflow-y-scroll overflow-x-hidden"> <div class="header d-flex flex-column p-3 text-center"> <div class="title pb-1"> <a class="h4 no-underline py-1 px-2 rounded-1" href="/" title="VictoriaMetrics"> <i class="fa fa-home"></i> VictoriaMetrics </a> </div> <span class="version"></span> <form class="search pt-2" action="/search.html" method="get" autocomplete="off"> <input class="form-control input-block input-sm" type="text" name="q" placeholder="Search docs..."> </form> </div> <div class="toctree py-2" data-spy="affix" role="navigation" aria-label="main navigation"> <ul> <li class="toc level-1 " data-sort="" data-level="1"> <a class="d-flex flex-items-baseline " href="/Cluster-VictoriaMetrics.html">Cluster version</a> </li> <li class="toc level-1 " data-sort="" data-level="1"> <a class="d-flex flex-items-baseline " href="/ExtendedPromQL.html">MetricsQL</a> </li> <li class="toc level-1 " data-sort="" data-level="1"> <a class="d-flex flex-items-baseline " href="/Home.html">Docs</a> </li> <li class="toc level-1 " data-sort="" data-level="1"> <a class="d-flex flex-items-baseline " href="/Quick-Start.html">Quick Start</a> </li> <li class="toc level-1 " data-sort="" data-level="1"> <a class="d-flex flex-items-baseline " href="/Release-Guide.html">Release-Guide.md</a> </li> <li class="toc level-1 " data-sort="" data-level="1"> <a class="d-flex flex-items-baseline " href="/SampleSizeCalculations.html">Sample size calculations</a> </li> <li class="toc level-1 " data-sort="" data-level="1"> <a class="d-flex flex-items-baseline " href="/Single-server-VictoriaMetrics.html">Single-server-VictoriaMetrics.md</a> </li> <li class="toc level-1 " data-sort="" data-level="1"> <a class="d-flex flex-items-baseline " href="/vmagent.html">vmagent</a> </li> <li class="toc level-1 " data-sort="" data-level="1"> <a class="d-flex flex-items-baseline " href="/vmalert.html">vmalert</a> </li> <li class="toc level-1 " data-sort="" data-level="1"> <a class="d-flex flex-items-baseline " href="/vmauth.html">vmauth</a> </li> <li class="toc level-1 current" data-sort="" data-level="1"> <a class="d-flex flex-items-baseline current" href="/vmbackup.html">vmbackup</a> </li> <li class="toc level-1 " data-sort="" data-level="1"> <a class="d-flex flex-items-baseline " href="/vmctl.html">vmctl</a> </li> <li class="toc level-1 " data-sort="" data-level="1"> <a class="d-flex flex-items-baseline " href="/vmrestore.html">vmrestore</a> </li> </ul> </div> </div> </div> <div class="content-wrap"> <div class="header d-flex flex-justify-between p-2 hide-lg hide-xl" aria-label="top navigation"> <button id="toggle" aria-label="Toggle menu" class="btn-octicon p-2 m-0 text-white" type="button"> <i class="fa fa-bars"></i> </button> <div class="title flex-1 d-flex flex-justify-center"> <a class="h4 no-underline py-1 px-2 rounded-1" href="/">VictoriaMetrics</a> </div> </div> <div class="content p-3 p-sm-5"> <div class="navigation-top d-flex flex-justify-between"> <ul class="breadcrumb" role="navigation" aria-label="breadcrumbs navigation"> <li class="breadcrumb-item"> <a class="no-underline" href="/" title="/"> <i class="fa fa-home"></i> </a> </li><li class="breadcrumb-item" aria-current="page">vmbackup.md</li></ul> <a class="edit" href="https://github.com/Brensted/test1/edit/gh-pages/vmbackup.md" title="Edit on GitHub" rel="noreferrer" target="_blank"> <i class="fa fa-edit"></i> </a> </div> <hr> <div role="main" itemscope="itemscope" itemtype="https://schema.org/Article"> <div class="markdown-body" itemprop="articleBody"> <h2 id="vmbackup">vmbackup</h2> <p><code class="language-plaintext highlighter-rouge notranslate">vmbackup</code> creates VictoriaMetrics data backups from <a href="https://victoriametrics.github.io/Single-server-VictoriaMetrics.html#how-to-work-with-snapshots">instant snapshots</a>.</p> <p>Supported storage systems for backups:</p> <ul> <li><a href="https://cloud.google.com/storage/">GCS</a>. Example: <code class="language-plaintext highlighter-rouge notranslate">gcs://&lt;bucket&gt;/&lt;path/to/backup&gt;</code></li> <li><a href="https://aws.amazon.com/s3/">S3</a>. Example: <code class="language-plaintext highlighter-rouge notranslate">s3://&lt;bucket&gt;/&lt;path/to/backup&gt;</code></li> <li>Any S3-compatible storage such as <a href="https://github.com/minio/minio">MinIO</a>, <a href="https://docs.ceph.com/docs/mimic/radosgw/s3/">Ceph</a> or <a href="https://www.swiftstack.com/docs/admin/middleware/s3_middleware.html">Swift</a>. See <a href="#advanced-usage">these docs</a> for details.</li> <li>Local filesystem. Example: <code class="language-plaintext highlighter-rouge notranslate">fs://&lt;/absolute/path/to/backup&gt;</code></li> </ul> <p><code class="language-plaintext highlighter-rouge notranslate">vmbackup</code> supports incremental and full backups. Incremental backups created automatically if the destination path already contains data from the previous backup. Full backups can be sped up with <code class="language-plaintext highlighter-rouge notranslate">-origin</code> pointing to already existing backup on the same remote storage. In this case <code class="language-plaintext highlighter-rouge notranslate">vmbackup</code> makes server-side copy for the shared data between the existing backup and new backup. It saves time and costs on data transfer.</p> <p>Backup process can be interrupted at any time. It is automatically resumed from the interruption point when restarting <code class="language-plaintext highlighter-rouge notranslate">vmbackup</code> with the same args.</p> <p>Backed up data can be restored with <a href="https://victoriametrics.github.io/vmrestore.html">vmrestore</a>.</p> <p>See <a href="https://medium.com/@valyala/speeding-up-backups-for-big-time-series-databases-533c1a927883">this article</a> for more details.</p> <p>See also <a href="https://github.com/VictoriaMetrics/VictoriaMetrics/issues/466">vmbackupmanager</a> tool built on top of <code class="language-plaintext highlighter-rouge notranslate">vmbackup</code>. This tool simplifies creation of hourly, daily, weekly and monthly backups.</p> <h2 id="use-cases">Use cases</h2> <h3 id="regular-backups">Regular backups</h3> <p>Regular backup can be performed with the following command:</p> <div class="language-plaintext highlighter-rouge notranslate"><div class="highlight"><pre class="highlight"><code>vmbackup -storageDataPath=&lt;/path/to/victoria-metrics-data&gt; -snapshotName=&lt;local-snapshot&gt; -dst=gcs://&lt;bucket&gt;/&lt;path/to/new/backup&gt;
</code></pre>  </div></div> <ul> <li><code class="language-plaintext highlighter-rouge notranslate">&lt;/path/to/victoria-metrics-data&gt;</code> - path to VictoriaMetrics data pointed by <code class="language-plaintext highlighter-rouge notranslate">-storageDataPath</code> command-line flag in single-node VictoriaMetrics or in cluster <code class="language-plaintext highlighter-rouge notranslate">vmstorage</code>. There is no need to stop VictoriaMetrics for creating backups, since they are performed from immutable <a href="https://victoriametrics.github.io/Single-server-VictoriaMetrics.html#how-to-work-with-snapshots">instant snapshots</a>.</li> <li><code class="language-plaintext highlighter-rouge notranslate">&lt;local-snapshot&gt;</code> is the snapshot to back up. See <a href="https://victoriametrics.github.io/Single-server-VictoriaMetrics.html#how-to-work-with-snapshots">how to create instant snapshots</a>.</li> <li><code class="language-plaintext highlighter-rouge notranslate">&lt;bucket&gt;</code> is an already existing name for <a href="https://cloud.google.com/storage/docs/creating-buckets">GCS bucket</a>.</li> <li><code class="language-plaintext highlighter-rouge notranslate">&lt;path/to/new/backup&gt;</code> is the destination path where new backup will be placed.</li> </ul> <h3 id="regular-backups-with-server-side-copy-from-existing-backup">Regular backups with server-side copy from existing backup</h3> <p>If the destination GCS bucket already contains the previous backup at <code class="language-plaintext highlighter-rouge notranslate">-origin</code> path, then new backup can be sped up with the following command:</p> <div class="language-plaintext highlighter-rouge notranslate"><div class="highlight"><pre class="highlight"><code>vmbackup -storageDataPath=&lt;/path/to/victoria-metrics-data&gt; -snapshotName=&lt;local-snapshot&gt; -dst=gcs://&lt;bucket&gt;/&lt;path/to/new/backup&gt; -origin=gcs://&lt;bucket&gt;/&lt;path/to/existing/backup&gt;
</code></pre>  </div></div> <p>It saves time and network bandwidth costs by performing server-side copy for the shared data from the <code class="language-plaintext highlighter-rouge notranslate">-origin</code> to <code class="language-plaintext highlighter-rouge notranslate">-dst</code>.</p> <h3 id="incremental-backups">Incremental backups</h3> <p>Incremental backups performed if <code class="language-plaintext highlighter-rouge notranslate">-dst</code> points to an already existing backup. In this case only new data uploaded to remote storage. It saves time and network bandwidth costs when working with big backups:</p> <div class="language-plaintext highlighter-rouge notranslate"><div class="highlight"><pre class="highlight"><code>vmbackup -storageDataPath=&lt;/path/to/victoria-metrics-data&gt; -snapshotName=&lt;local-snapshot&gt; -dst=gcs://&lt;bucket&gt;/&lt;path/to/existing/backup&gt;
</code></pre>  </div></div> <h3 id="smart-backups">Smart backups</h3> <p>Smart backups mean storing full daily backups into <code class="language-plaintext highlighter-rouge notranslate">YYYYMMDD</code> folders and creating incremental hourly backup into <code class="language-plaintext highlighter-rouge notranslate">latest</code> folder:</p> <ul> <li>Run the following command every hour:</li> </ul> <div class="language-plaintext highlighter-rouge notranslate"><div class="highlight"><pre class="highlight"><code>vmbackup -snapshotName=&lt;latest-snapshot&gt; -dst=gcs://&lt;bucket&gt;/latest
</code></pre>  </div></div> <p>Where <code class="language-plaintext highlighter-rouge notranslate">&lt;latest-snapshot&gt;</code> is the latest <a href="https://victoriametrics.github.io/Single-server-VictoriaMetrics.html#how-to-work-with-snapshots">snapshot</a>. The command will upload only changed data to <code class="language-plaintext highlighter-rouge notranslate">gcs://&lt;bucket&gt;/latest</code>.</p> <ul> <li>Run the following command once a day:</li> </ul> <div class="language-plaintext highlighter-rouge notranslate"><div class="highlight"><pre class="highlight"><code>vmbackup -snapshotName=&lt;daily-snapshot&gt; -dst=gcs://&lt;bucket&gt;/&lt;YYYYMMDD&gt; -origin=gcs://&lt;bucket&gt;/latest
</code></pre>  </div></div> <p>Where <code class="language-plaintext highlighter-rouge notranslate">&lt;daily-snapshot&gt;</code> is the snapshot for the last day <code class="language-plaintext highlighter-rouge notranslate">&lt;YYYYMMDD&gt;</code>.</p> <p>This apporach saves network bandwidth costs on hourly backups (since they are incremental) and allows recovering data from either the last hour (<code class="language-plaintext highlighter-rouge notranslate">latest</code> backup) or from any day (<code class="language-plaintext highlighter-rouge notranslate">YYYYMMDD</code> backups). Note that hourly backup shouldn't run when creating daily backup.</p> <p>Do not forget removing old snapshots and backups when they are no longer needed for saving storage costs.</p> <p>See also <a href="https://github.com/VictoriaMetrics/VictoriaMetrics/issues/466">vmbackupmanager tool</a> for automating smart backups.</p> <h2 id="how-does-it-work">How does it work?</h2> <p>The backup algorithm is the following:</p> <ol> <li>Collect information about files in the <code class="language-plaintext highlighter-rouge notranslate">-snapshotName</code>, in the <code class="language-plaintext highlighter-rouge notranslate">-dst</code> and in the <code class="language-plaintext highlighter-rouge notranslate">-origin</code>.</li> <li>Determine files in <code class="language-plaintext highlighter-rouge notranslate">-dst</code>, which are missing in <code class="language-plaintext highlighter-rouge notranslate">-snapshotName</code>, and delete them. These are usually small files, which are already merged into bigger files in the snapshot.</li> <li>Determine files from <code class="language-plaintext highlighter-rouge notranslate">-snapshotName</code>, which are missing in <code class="language-plaintext highlighter-rouge notranslate">-dst</code>. These are usually small new files and bigger merged files.</li> <li>Determine files from step 3, which exist in the <code class="language-plaintext highlighter-rouge notranslate">-origin</code>, and perform server-side copy of these files from <code class="language-plaintext highlighter-rouge notranslate">-origin</code> to <code class="language-plaintext highlighter-rouge notranslate">-dst</code>. These are usually the biggest and the oldest files, which are shared between backups.</li> <li>Upload the remaining files from step 3 from <code class="language-plaintext highlighter-rouge notranslate">-snapshotName</code> to <code class="language-plaintext highlighter-rouge notranslate">-dst</code>.</li> </ol> <p>The algorithm splits source files into 100 MB chunks in the backup. Each chunk stored as a separate file in the backup. Such splitting minimizes the amounts of data to re-transfer after temporary errors.</p> <p><code class="language-plaintext highlighter-rouge notranslate">vmbackup</code> relies on <a href="https://medium.com/@valyala/how-victoriametrics-makes-instant-snapshots-for-multi-terabyte-time-series-data-e1f3fb0e0282">instant snapshot</a> properties:</p> <ul> <li>All the files in the snapshot are immutable.</li> <li>Old files periodically merged into new files.</li> <li>Smaller files have higher probability to be merged.</li> <li>Consecutive snapshots share many identical files.</li> </ul> <p>These properties allow performing fast and cheap incremental backups and server-side copying from <code class="language-plaintext highlighter-rouge notranslate">-origin</code> paths. See <a href="https://medium.com/@valyala/speeding-up-backups-for-big-time-series-databases-533c1a927883">this article</a> for more details. <code class="language-plaintext highlighter-rouge notranslate">vmbackup</code> can work improperly or slowly when these properties are violated.</p> <h2 id="troubleshooting">Troubleshooting</h2> <ul> <li>If the backup is slow, then try setting higher value for <code class="language-plaintext highlighter-rouge notranslate">-concurrency</code> flag. This will increase the number of concurrent workers that upload data to backup storage.</li> <li>If <code class="language-plaintext highlighter-rouge notranslate">vmbackup</code> eats all the network bandwidth, then set <code class="language-plaintext highlighter-rouge notranslate">-maxBytesPerSecond</code> to the desired value.</li> <li>If <code class="language-plaintext highlighter-rouge notranslate">vmbackup</code> has been interrupted due to temporary error, then just restart it with the same args. It will resume the backup process.</li> <li>Backups created from <a href="https://victoriametrics.github.io/Single-server-VictoriaMetrics.html">single-node VictoriaMetrics</a> cannot be restored at <a href="https://victoriametrics.github.io/Cluster-VictoriaMetrics.html">cluster VictoriaMetrics</a> and vice versa.</li> </ul> <h2 id="advanced-usage">Advanced usage</h2> <ul> <li> <p>Obtaining credentials from a file.</p> <p>Add flag <code class="language-plaintext highlighter-rouge notranslate">-credsFilePath=/etc/credentials</code> with the following content:</p> <p>for s3 (aws, minio or other s3 compatible storages):</p> <div class="language-bash highlighter-rouge notranslate"><div class="highlight"><pre class="highlight"><code>   <span class="o">[</span>default]
   <span class="nv">aws_access_key_id</span><span class="o">=</span>theaccesskey
   <span class="nv">aws_secret_access_key</span><span class="o">=</span>thesecretaccesskeyvalue
</code></pre>  </div> </div> <p>for gce cloud storage:</p> <div class="language-json highlighter-rouge notranslate"><div class="highlight"><pre class="highlight"><code><span class="w">  </span><span class="p">{</span><span class="w">
         </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"service_account"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"project_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"project-id"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"private_key_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"key-id"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"private_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-----BEGIN PRIVATE KEY-----</span><span class="se">\n</span><span class="s2">private-key</span><span class="se">\n</span><span class="s2">-----END PRIVATE KEY-----</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"client_email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"service-account-email"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"client_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"client-id"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"auth_uri"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://accounts.google.com/o/oauth2/auth"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"token_uri"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://accounts.google.com/o/oauth2/token"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"auth_provider_x509_cert_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://www.googleapis.com/oauth2/v1/certs"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"client_x509_cert_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://www.googleapis.com/robot/v1/metadata/x509/service-account-email"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre>  </div> </div> </li> <li>Usage with s3 custom url endpoint. It is possible to use <code class="language-plaintext highlighter-rouge notranslate">vmbackup</code> with s3 compatible storages like minio, cloudian, etc. You have to add a custom url endpoint via flag: <div class="language-plaintext highlighter-rouge notranslate"><div class="highlight"><pre class="highlight"><code># for minio
-customS3Endpoint=http://localhost:9000

# for aws gov region
-customS3Endpoint=https://s3-fips.us-gov-west-1.amazonaws.com
</code></pre>  </div> </div> </li> <li>Run <code class="language-plaintext highlighter-rouge notranslate">vmbackup -help</code> in order to see all the available options:</li> </ul> <div class="language-plaintext highlighter-rouge notranslate"><div class="highlight"><pre class="highlight"><code>  -concurrency int
    	The number of concurrent workers. Higher concurrency may reduce backup duration (default 10)
  -configFilePath string
    	Path to file with S3 configs. Configs are loaded from default location if not set.
    	See https://docs.aws.amazon.com/general/latest/gr/aws-security-credentials.html
  -configProfile string
    	Profile name for S3 configs. If no set, the value of the environment variable will be loaded (AWS_PROFILE or AWS_DEFAULT_PROFILE), or if both not set, DefaultSharedConfigProfile is used
  -credsFilePath string
    	Path to file with GCS or S3 credentials. Credentials are loaded from default locations if not set.
    	See https://cloud.google.com/iam/docs/creating-managing-service-account-keys and https://docs.aws.amazon.com/general/latest/gr/aws-security-credentials.html
  -customS3Endpoint string
    	Custom S3 endpoint for use with S3-compatible storages (e.g. MinIO). S3 is used if not set
  -dst string
    	Where to put the backup on the remote storage. Example: gcs://bucket/path/to/backup/dir, s3://bucket/path/to/backup/dir or fs:///path/to/local/backup/dir
    	-dst can point to the previous backup. In this case incremental backup is performed, i.e. only changed data is uploaded
  -envflag.enable
    	Whether to enable reading flags from environment variables additionally to command line. Command line flag values have priority over values from environment vars. Flags are read only from command line if this flag isn't set
  -envflag.prefix string
    	Prefix for environment variables if -envflag.enable is set
  -fs.disableMmap
    	Whether to use pread() instead of mmap() for reading data files. By default mmap() is used for 64-bit arches and pread() is used for 32-bit arches, since they cannot read data files bigger than 2^32 bytes in memory. mmap() is usually faster for reading small data chunks than pread()
  -loggerErrorsPerSecondLimit int
    	Per-second limit on the number of ERROR messages. If more than the given number of errors are emitted per second, then the remaining errors are suppressed. Zero value disables the rate limit (default 10)
  -loggerFormat string
    	Format for logs. Possible values: default, json (default "default")
  -loggerLevel string
    	Minimum level of errors to log. Possible values: INFO, WARN, ERROR, FATAL, PANIC (default "INFO")
  -loggerOutput string
    	Output for the logs. Supported values: stderr, stdout (default "stderr")
  -maxBytesPerSecond value
    	The maximum upload speed. There is no limit if it is set to 0
    	Supports the following optional suffixes for values: KB, MB, GB, KiB, MiB, GiB (default 0)
  -memory.allowedBytes value
    	Allowed size of system memory VictoriaMetrics caches may occupy. This option overrides -memory.allowedPercent if set to non-zero value. Too low value may increase cache miss rate, which usually results in higher CPU and disk IO usage. Too high value may evict too much data from OS page cache, which will result in higher disk IO usage
    	Supports the following optional suffixes for values: KB, MB, GB, KiB, MiB, GiB (default 0)
  -memory.allowedPercent float
    	Allowed percent of system memory VictoriaMetrics caches may occupy. See also -memory.allowedBytes. Too low value may increase cache miss rate, which usually results in higher CPU and disk IO usage. Too high value may evict too much data from OS page cache, which will result in higher disk IO usage (default 60)
  -origin string
    	Optional origin directory on the remote storage with old backup for server-side copying when performing full backup. This speeds up full backups
  -snapshot.createURL string
    	VictoriaMetrics create snapshot url. When this is given a snapshot will automatically be created during backup. Example: http://victoriametrics:8428/snaphsot/create
  -snapshot.deleteURL string
    	VictoriaMetrics delete snapshot url. Optional. Will be generated from -snapshot.createURL if not provided. All created snaphosts will be automatically deleted. Example: http://victoriametrics:8428/snaphsot/delete
  -snapshotName string
    	Name for the snapshot to backup. See https://victoriametrics.github.io/Single-server-VictoriaMetrics.html#how-to-work-with-snapshots
  -storageDataPath string
    	Path to VictoriaMetrics data. Must match -storageDataPath from VictoriaMetrics or vmstorage (default "victoria-metrics-data")
  -version
    	Show VictoriaMetrics version
</code></pre>  </div></div> <h2 id="how-to-build-from-sources">How to build from sources</h2> <p>It is recommended using <a href="https://github.com/VictoriaMetrics/VictoriaMetrics/releases">binary releases</a> - see <code class="language-plaintext highlighter-rouge notranslate">vmutils-*</code> archives there.</p> <h3 id="development-build">Development build</h3> <ol> <li><a href="https://golang.org/doc/install">Install Go</a>. The minimum supported version is Go 1.13.</li> <li>Run <code class="language-plaintext highlighter-rouge notranslate">make vmbackup</code> from the root folder of the repository. It builds <code class="language-plaintext highlighter-rouge notranslate">vmbackup</code> binary and puts it into the <code class="language-plaintext highlighter-rouge notranslate">bin</code> folder.</li> </ol> <h3 id="production-build">Production build</h3> <ol> <li><a href="https://docs.docker.com/install/">Install docker</a>.</li> <li>Run <code class="language-plaintext highlighter-rouge notranslate">make vmbackup-prod</code> from the root folder of the repository. It builds <code class="language-plaintext highlighter-rouge notranslate">vmbackup-prod</code> binary and puts it into the <code class="language-plaintext highlighter-rouge notranslate">bin</code> folder.</li> </ol> <h3 id="building-docker-images">Building docker images</h3> <p>Run <code class="language-plaintext highlighter-rouge notranslate">make package-vmbackup</code>. It builds <code class="language-plaintext highlighter-rouge notranslate">victoriametrics/vmbackup:&lt;PKG_TAG&gt;</code> docker image locally. <code class="language-plaintext highlighter-rouge notranslate">&lt;PKG_TAG&gt;</code> is auto-generated image tag, which depends on source code in the repository. The <code class="language-plaintext highlighter-rouge notranslate">&lt;PKG_TAG&gt;</code> may be manually set via <code class="language-plaintext highlighter-rouge notranslate">PKG_TAG=foobar make package-vmbackup</code>.</p> <p>The base docker image is <a href="https://hub.docker.com/_/alpine">alpine</a> but it is possible to use any other base image by setting it via <code class="language-plaintext highlighter-rouge notranslate">&lt;ROOT_IMAGE&gt;</code> environment variable. For example, the following command builds the image on top of <a href="https://hub.docker.com/_/scratch">scratch</a> image:</p> <div class="language-bash highlighter-rouge notranslate"><div class="highlight"><pre class="highlight"><code><span class="nv">ROOT_IMAGE</span><span class="o">=</span>scratch make package-vmbackup
</code></pre>  </div></div> </div> </div> <div class="navigation-bottom d-flex flex-justify-between py-3" role="navigation" aria-label="footer navigation"> <div class="prev"><a href="/vmauth.html" class="btn" title="vmauth" accesskey="p" rel="prev"> <i class="fa fa-arrow-circle-left"></i> Previous </a></div> <div class="next"><a href="/vmctl.html" class="btn" title="vmctl" accesskey="n" rel="next"> Next <i class="fa fa-arrow-circle-right"></i> </a></div> </div><hr> <div class="copyright text-center text-gray" role="contentinfo"> <i class="fa fa-copyright"></i> <span class="time">2021,</span> <a class="text-gray" href="https://github.com/Brensted" rel="noreferrer" target="_blank">Brensted</a> Revision <a class="text-gray" href="https://github.com/Brensted/test1/commit/156072bda364bc719a657b8c14a5f5ba4c757132" title="156072bda364bc719a657b8c14a5f5ba4c757132" rel="noreferrer" target="_blank">156072b</a> <br> <div class="generator"> Built with <a href="https://pages.github.com" rel="noreferrer" target="_blank" title="github-pages v209">GitHub Pages</a> using a <a href="https://github.com/rundocs/jekyll-rtd-theme" rel="noreferrer" target="_blank" title="rundocs/jekyll-rtd-theme v2.0.10">theme</a> provided by <a href="https://rundocs.io" rel="noreferrer" target="_blank">RunDocs</a>. </div> </div> </div> </div> <div class="addons-wrap d-flex flex-column overflow-y-auto"> <div class="status d-flex flex-justify-between p-2"> <div class="title p-1"> <i class="fa fa-book"></i> VictoriaMetrics </div> <div class="branch p-1"> <span class="name"> gh-pages </span> <i class="fa fa-caret-down"></i> </div> </div> <div class="addons d-flex flex-column height-full p-2 d-none"> <dl> <dt>GitHub</dt> <dd> <a href="https://github.com/Brensted/test1" title="Stars: 0"> <i class="fa fa-github"></i> Homepage </a> </dd> <dd> <a href="https://github.com/Brensted/test1/issues" title="Open issues: 0"> <i class="fa fa-question-circle-o"></i> Issues </a> </dd> <dd> <a href="https://github.com/Brensted/test1/zipball/gh-pages" title="Size: 0 Kb"> <i class="fa fa-download"></i> Download </a> </dd> </dl> <hr> <div class="license f6 pb-2"> This <a href="/" title="VictoriaMetrics">Software</a> is under the terms of <a href="https://github.com/Brensted/test1">The Unlicense</a>. </div> </div> </div> <script src="https://cdn.jsdelivr.net/gh/rundocs/jekyll-rtd-theme@2.0.10/assets/js/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/gh/rundocs/jekyll-rtd-theme@2.0.10/assets/js/theme.min.js"></script> </body> </html>